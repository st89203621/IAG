关联率相关问题
整个功能实现逻辑：Mapping发送张三/8.8.8.8的上线报文给NF(信令的报文在NF后台)，并记录信令信息(HY提供)；NF读取信令认证成功了(认证调试日志在NF后台)，张三/8.8.8.8才会上线；张三/8.8.8.8上线了，审计的行为日志才会以张三/8.8.8.8作为User name字段去记录；NF记录了张三/8.8.8.8的行为日志，才会发送到DC(在DC中，A3局点对应的是237)；DC里面有了审计日志，入了库，才能倒过来检查审计日志是否符合Mapping发送上线信令。

统计的逻辑是：通过审计的行为日志，看有无用户名和mapping信令记录尤其是上线时间点不一致。

常见问题有两类：重点关注常见问题1：一直没有关联上，例如16点60分发送的上线信令，在没有发送下线信令前，审计日志的用户名显示的是8.8.8.8而不是张三
常见问题2：突然一条审计日志没关联上，比如前面10条记录张三，后面30条用户名也记录的是张三，就中间有一条日志用户名是8.8.8.8

问题分析的逻辑总的来说就是看哪个环节出问题，例如对常见问题1，有mapping上线日志，看实际有没有发信令(看NF信令包)，没有信令说明mapping可能负载有问题，如果有上线信令，看NF认证有没有正确处理(看NF认证调试日志)
对于常见问题2，主要看是否距离上线时间不长，不长则意味着8.8.8.8可能先有流量或者不是张三在用，然后发送的张三/8.8.8.8信令上线，所以上线前的连接是没有认证的信息的，其用户名就是8.8.8.8；上线时间长，则可能是BUG或者长连接。


常见问题1：一直没有关联上  *重点关注
1.先从给的审计日志里面看，看到device ID，一般是8个字符，由数字和a到f的数字组成，通过deviceID可以唯一这个日志来自哪台IAG
A2 A3局点 gatewayid和ip对应关系.xlsx

2.进入IAG后台

3.获取信令包，进入/data/hy_radius开头的文件夹
cd /data/hy tab补全，这里面的包是按照每小时每分钟抓的上下线信令包，例如后缀00_01表示00点01分抓的包，异常日志对应的用户，mapping上线信令是什么时间点，就取什么时间点前后半小时的信令包，并压缩，例如早上9点15上线，就把9点1X这个时间段的包都取出来。

每天循环抓包，如果现在是下午14点，那么意味着昨天00点到14点的信令包都被覆盖了，就不用取了，因为昨天被覆盖了。但是昨天下午14点之后到24点的信令包都还没有覆盖，如果异常日志对应的上线时间是昨天14点到24点之间，说明还有信令包可以取，因为没有被覆盖

4.获取认证调试日志，查看/tmp下是否有authysy.debug文件，有则说明开启了认证调试
进入/data/ac-auth-mon/ac-auth文件夹
cd /data/ac-auth-log/ac-auth

会看到有以日期命名的文件，认证进出重启时间/或者每天凌晨0点0分0秒，例如000000表示从0点0分0秒开始记录认证调试的信息，直到每天凌晨0到6点认证进程维护性重启，然后会在新的文件里面记录。
以20250516-000000表示0点分0秒会重新开一个文件记录认证信息，这个就是5月16号0点分0秒开始记录的认证信息，然后到了凌晨2点18分，认证进程维护性重新，后面的认证调试信息就在20250516-022819这个文件里面记录。
单个文件最大4G，能记录2到3个小时的日志，以5月16号的这个日志来看，000000后缀的这个文件记录的是0点0分0秒，到02点18分中间的日志，时间间隔也就2小时，说明0点到0点28分的日志应该是完整记录了。022819这个后缀表示02点28分19秒开始记录认证调试日志，但是到当天24点00分00秒中间过去了二十多个小时，说明前面的日志都被覆写了，能记录的也就21点到24点这个时间的日志。

按照mapping上线信令是什么时间点，取包含该时间点对应的认证调试日志。压缩，一定要打包压缩！！单个文件2到4G，不打包取出来慢，发给深信服研发也慢！！！
tar -czvf auth_202505XX.tar.gz 当天的日志文件

5.通过NF服务器及BBC版本升级记录_20250422表可以查询该deviceID对应的是哪个DC(除了273还有其他的DC)
NF IP Summary.xlsx


5.进入对应的dc，取Y表上线日志A表等审计日志
d盘的/data/aclog/db/log_data/aclog/，查看deviceID对应的文件夹 ，表示这台IAG设备对应的日志，进入后可以看到以日期命名的文件夹，例如20250527，里面有大量的A N Y等表。如果研发需要Y表，就把当前的mapping上线信令时间点当天的Y文件夹打包压缩。

其他看看研发需要什么表，进入对应的文件夹，里面可以看到大量数字编号的文件件，并且可以看到该文件夹的修改时间，把与事发时间前后的文件夹取出来。一定要打包压缩！！不打包取出来慢，发给深信服研发也慢！！！



常见问题2：突然关联不上
1.先从给的审计日志里面看，看到device ID，一般是8个字符，由数字和a到f的数字组成，通过deviceID可以唯一这个日志来自哪台IAG，可以得到IAG的IP地址
A2 A3局点 gatewayid和ip对应关系.xlsx

2.进入IAG后台

3.获取信令包，进入/data/hy_radius开头的文件夹
cd /data/hy tab补全，这里面的包是按照每小时每分钟抓的上下线信令包，例如后缀00_01表示00点01分抓的包，异常日志对应的用户，mapping上线信令是什么时间点，就取什么时间点前后半小时的信令包，并压缩，例如早上9点15上线，就把9点1X这个时间段的包都取出来。

每天循环抓包，如果现在是下午14点，那么意味着昨天00点到14点的信令包都被覆盖了，就不用取了，因为昨天被覆盖了。但是昨天下午14点之后到24点的信令包都还没有覆盖，如果异常日志对应的上线时间是昨天14点到24点之间，说明还有信令包可以取，因为没有被覆盖

4.获取认证调试日志，查看/tmp下是否有authysy.debug文件，有则说明开启了认证调试
进入/data/ac-auth-mon/ac-auth文件夹
cd /data/ac-auth-log/ac-auth

会看到有以日期命名的文件，认证进出重启时间/或者每天凌晨0点0分0秒，例如000000表示从0点0分0秒开始记录认证调试的信息，直到每天凌晨0到6点认证进程维护性重启，然后会在新的文件里面记录。
以20250516-000000表示0点分0秒会重新开一个文件记录认证信息，这个就是5月16号0点分0秒开始记录的认证信息，然后到了凌晨2点18分，认证进程维护性重新，后面的认证调试信息就在20250516-022819这个文件里面记录。
单个文件最大4G，能记录2到3个小时的日志，以5月16号的这个日志来看，000000后缀的这个文件记录的是0点0分0秒，到02点18分中间的日志，时间间隔也就2小时，说明0点到0点28分的日志应该是完整记录了。022819这个后缀表示02点28分19秒开始记录认证调试日志，但是到当天24点00分00秒中间过去了二十多个小时，说明前面的日志都被覆写了，能记录的也就21点到24点这个时间的日志。


按照mapping上线信令是什么时间点，取包含该时间点对应的认证调试日志。压缩，一定要打包压缩！！单个文件2到4G，不打包取出来慢，发给深信服研发也慢！！！
tar -czvf auth_202505XX.tar.gz 当天的日志文件


5.通过NF服务器及BBC版本升级记录_20250422表可以查询该deviceID对应的是哪个DC(除了273还有其他的DC)
NF IP Summary.xlsx


5.进入IAG对应的dc，取Y表上线日志A表等审计日志
d盘的/data/aclog/db/log_data/aclog/，查看deviceID对应的文件夹 ，表示这台IAG设备对应的日志，进入后可以看到以日期命名的文件夹，例如20250527，里面有大量的A N Y等表。如果研发需要Y表，就把当前的mapping上线信令时间点当天的Y文件夹打包压缩。

把异常日志(突然出现的那一条关联不上的日志)的出现时间，例如15点13分，进入出现时间当天所在的文件夹，例如编号20250527，进入A文件夹，查看0 1 2等目录中的大量数字命名的文件夹时间，把异常日志(突然出现的那一条关联不上的日志)的出现时间(例如15点13分)前后半小时的日志压缩打包。

